# Square Eyes (35 pts)
crypto

## Deskripsi
> It was taking forever to get a 2048 bit prime, so I just generated one and used it twice.
>
> Challenge files: 
> - [output.txt](https://cryptohack.org/static/challenges/output_00dace150c0bc52f7abf03fc3e9529d2.txt)

## Solusi
Diberikan nilai n, e, dan ct. kita diminta mendekripsi ct dengan informasi yang tersedia. 
diketahui bahwa n dibentuk dari dua bilangan prima besar yang sama. sebut saja $P$. <br>
artinya, $n = p^2$. 

p dapat dicari dengan melakukan operasi akar kuadrat pada n. mungkin akan sedikit terkendala karena nilai n lumayan besar.
gunakan sagemath di linux untuk memperoleh p.
``` sage
sage: n = 53586080804400955002917713570816801620145134314731356537101445902774349173942288544308470572073140971377552799
....: 371968258366916487380684204328843982807178997069475908084216225395525959055228304772878281294684516033480178208806
....: 815445302193672171026905098580505469209673877732179615338402489761559449345306813834120367374951409454600025363190
....: 299161719784758451969415212276540698213352659492868523238193474215219586138022122437085812873697595917686165104437
....: 037853909399019833629857294451273857083939658859009681321779119189594138046480337760277924066313383495232931686239
....: 958195059058800637122133412821540919760323694259767475672821223213405656271639915508010888110595276818919372882748
....: 466734937809110006822440468470167478239920037319243306276762284126405542603534976901811729962055480390249043233960
....: 056643224679581816746091618064739416915764724560355569273563086214871542879124276479946989692475347053985708076717
....: 005278391827318030483531838817708967423164091033774378975097921620257322679424033279789286827630940025392593222389
....: 553071416964811656901358164319234193180078525471508329452632598024721921836411887786489206818590558741097715273793
....: 6310734712276956663192182487672474651103240004173381041237906849437490609652395748868434296753449
sage: sqrt(n)
```

rumus tuotient euler untuk bilangan prima berpangkat :

$$ \phi(p^k) = p^{k-1}(p-1) $$

sehingga, untuk $k=2$ berlaku

$$ \phi(p^2) = p(p-1) $$

berikut adalah salah satu python script solvernya
``` python
phi = p * (p - 1)
d = inverse(e, phi)
pt = pow(ct, d, n)
decrypted = long_to_bytes(pt)
print(decrypted)
```
